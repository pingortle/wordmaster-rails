<%
def evaluate(letter, index)
  if @game.word[index] == letter.value
    :correct
  elsif @game.word.include?(letter.value)
    :correct_with_incorrect_location
  else
    :incorrect
  end
end

def style_attempt_background_color(letter, index)
  guess_to_css = {
    correct: "lightgreen",
    incorrect: "revert",
    correct_with_incorrect_location: "lightyellow"
  }
  guess_to_css[evaluate(letter, index)]
end
%>
<% @game.attempts.each do |attempt| %>
  <% attempt.letters.each_with_index do |letter, index| %>
    <input type=text value="<%= letter.value %>" style="background-color: <%= style_attempt_background_color(letter, index) %>" autocomplete=nope size=1 maxlength=1 minlength=1 disabled>
  <% end %>
  <br>
<% end %>

<%= form_with model: [@game, @game.current_attempt] do |form| %>
  <%= form.fields_for :letters do |letters_fields| %>
    <%= letters_fields.text_field :value, autocomplete: "off", size: 1, maxlength: 1, minlength: 1, required: true %>
  <% end %>
  <%= form.submit "Guess" %>
<% end %>

<% @game.remaining_attempts.each do |attempt| %>
  <% attempt.letters.each do %>
    <input type=text autocomplete=nope size=1 maxlength=1 minlength=1 disabled>
  <% end %>
  <br>
<% end %>
